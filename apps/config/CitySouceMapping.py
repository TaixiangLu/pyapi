#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Time    : 2018/4/17 下午1:55
# @Author  : janguo@zhugefang.com
# @Site    : 
# @File    : CitySouceMapping.py
# @Software: PyCharm

city_mapping={
    'bj': {
		'id': '1',
		'fpy': 'beijing'
	},
	'sh': {
		'id': '2',
		'fpy': 'shanghai'
	},
	'sz': {
		'id': '3',
		'fpy': 'shenzhen'
	},
	'wh': {
		'id': '4',
		'fpy': 'wuhan'
	},
	'cd': {
		'id': '5',
		'fpy': 'chengdu'
	},
	'nj': {
		'id': '6',
		'fpy': 'nanjing'
	},
	'tj': {
		'id': '7',
		'fpy': 'tianjin'
	},
	'hz': {
		'id': '8',
		'fpy': 'hangzhou'
	},
	'cq': {
		'id': '9',
		'fpy': 'chongqing'
	},
	'sy': {
		'id': '10',
		'fpy': 'shenyang'
	},
	'dl': {
		'id': '11',
		'fpy': 'dalian'
	},
	'qd': {
		'id': '12',
		'fpy': 'qingdao'
	},
	'su': {
		'id': '13',
		'fpy': 'suzhou'
	},
	'zz': {
		'id': '15',
		'fpy': 'zhengzhou'
	},
	'gz': {
		'id': '16',
		'fpy': 'guangzhou'
	},
	'jn': {
		'id': '17',
		'fpy': 'jinan'
	},
	'km': {
		'id': '18',
		'fpy': 'kunming'
	},
	'cc': {
		'id': '19',
		'fpy': 'changchun'
	},
	'xa': {
		'id': '20',
		'fpy': 'xian'
	},
	'heb': {
		'id': '21',
		'fpy': 'haerbin'
	},
	'cs': {
		'id': '22',
		'fpy': 'changsha'
	},
	'wx': {
		'id': '23',
		'fpy': 'wuxi'
	},
	'sjz': {
		'id': '24',
		'fpy': 'shijiazhuang'
	},
	'jh': {
		'id': '25',
		'fpy': 'jinhua'
	},
	'dg': {
		'id': '26',
		'fpy': 'dongguan'
	},
	'hf': {
		'id': '27',
		'fpy': 'hefei'
	},
	'nn': {
		'id': '28',
		'fpy': 'nanning'
	},
	'fz': {
		'id': '29',
		'fpy': 'fuzhou'
	},
	'nc': {
		'id': '30',
		'fpy': 'nanchang'
	},
	'nb': {
		'id': '31',
		'fpy': 'ningbo'
	},
	'cz': {
		'id': '32',
		'fpy': 'changzhou'
	},
	'zh': {
		'id': '33',
		'fpy': 'zhuhai'
	},
	'hn': {
		'id': '34',
		'fpy': 'hainan'
	},
	'yt': {
		'id': '35',
		'fpy': 'yantai'
	},
	'huizhou': {
		'id': '36',
		'fpy': 'huizhou'
	},
	'zs': {
		'id': '37',
		'fpy': 'zhongshan'
	},
	'lz': {
		'id': '38',
		'fpy': 'lanzhou'
	},
	'ks': {
		'id': '39',
		'fpy': 'kunshan'
	},
	'xz': {
		'id': '40',
		'fpy': 'xuzhou'
	},
	'yz': {
		'id': '41',
		'fpy': 'yangzhou'
	},
	'ly': {
		'id': '42',
		'fpy': 'luoyang'
	},
	'wf': {
		'id': '43',
		'fpy': 'weifang'
	},
	'xm': {
		'id': '44',
		'fpy': 'xiamen'
	},
	'nt': {
		'id': '45',
		'fpy': 'nantong'
	},
	'yc': {
		'id': '46',
		'fpy': 'yichang'
	},
	'jm': {
		'id': '47',
		'fpy': 'jiangmen'
	},
	'guilin': {
		'id': '48',
		'fpy': 'guilin'
	},
	'taizhou': {
		'id': '49',
		'fpy': 'taizhou'
	},
	'taiyuan': {
		'id': '50',
		'fpy': 'taiyuan'
	},
	'sx': {
		'id': '51',
		'fpy': 'shaoxing'
	},
	'qz': {
		'id': '52',
		'fpy': 'quanzhou'
	},
	'gy': {
		'id': '53',
		'fpy': 'guiyang'
	},
	'bd': {
		'id': '54',
		'fpy': 'baoding'
	},
	'ts': {
		'id': '55',
		'fpy': 'tangshan'
	},
	'weihai': {
		'id': '56',
		'fpy': 'weihai'
	},
	'qhd': {
		'id': '57',
		'fpy': 'qinhuangdao'
	},
	'yinchuan': {
		'id': '58',
		'fpy': 'yinchuan'
	},
	'lf': {
		'id': '59',
		'fpy': 'langfang'
	},
	'hhht': {
		'id': '60',
		'fpy': 'huhehaote'
	},
	'fs': {
		'id': '62',
		'fpy': 'foshan'
	},
	'jx': {
		'id': '63',
		'fpy': 'jiaxing'
	},
	'wz': {
		'id': '64',
		'fpy': 'wenzhou'
	},
	'xianyang': {
		'id': '65',
		'fpy': 'xianyang'
	},
	'jiujiang': {
		'id': '66',
		'fpy': 'jiujiang'
	},
	'wlmq': {
		'id': '67',
		'fpy': 'wulumuqi'
	},
	'bh': {
		'id': '68',
		'fpy': 'beihai'
	},
	'lyg': {
		'id': '69',
		'fpy': 'lianyungang'
	},
	'tz': {
		'id': '70',
		'fpy': 'tz'
	},
	'zhenjiang': {
		'id': '71',
		'fpy': 'zhenjiang'
	},
	'huzhou': {
		'id': '72',
		'fpy': 'huzhou'
	},
	'yancheng': {
		'id': '73',
		'fpy': 'yancheng'
	},
	'st': {
		'id': '74',
		'fpy': 'shantou'
	},
	'hd': {
		'id': '75',
		'fpy': 'handan'
	},
	'wuhu': {
		'id': '76',
		'fpy': 'wuhu'
	},
	'mianyang': {
		'id': '77',
		'fpy': 'mianyang'
	},
	'ganzhou': {
		'id': '78',
		'fpy': 'ganzhou'
	},
	'huaian': {
		'id': '79',
		'fpy': 'huaian'
	},
	'bt': {
		'id': '80',
		'fpy': 'baotou'
	},
	'dali': {
		'id': '82',
		'fpy': 'dali'
	},
	'qujing': {
		'id': '83',
		'fpy': 'qujing'
	},
	'ls': {
		'id': '84',
		'fpy': 'lishui'
	},
	'chengde': {
		'id': '85',
		'fpy': 'chengde'
	},
	'zhangjiakou': {
		'id': '86',
		'fpy': 'zhangjiakou'
	},
	'zhuzhou': {
		'id': '87',
		'fpy': 'zhuzhou'
	},
	'sq': {
		'id': '88',
		'fpy': 'suqian'
	},
	'xx': {
		'id': '89',
		'fpy': 'xinxiang'
	},
	'xn': {
		'id': '90',
		'fpy': 'xining'
	},
	'nanyang': {
		'id': '91',
		'fpy': 'nanyang'
	},
	'anshan': {
		'id': '92',
		'fpy': 'anshan'
	},
	'daqing': {
		'id': '95',
		'fpy': 'daqing'
	},
	'jining': {
		'id': '97',
		'fpy': 'jining'
	},
	'zb': {
		'id': '102',
		'fpy': 'zibo'
	},
	'zhangzhou': {
		'id': '103',
		'fpy': 'zhangzhou'
	},
	'zj': {
		'id': '105',
		'fpy': 'zhanjiang'
	},
	'linyi': {
		'id': '106',
		'fpy': 'linyi'
	}
}

def get_db(type, city):
    not_bj = {"borough": "spider",
              "plathouse": "spider", "new_plathouse": "spider",
              "sell": "spider", "new_sell": "spider",
              }
    bj = {"brokerhouse": "brokerhouse", "complex": "newhouse", "building": "building",
          "brokerbd": "brokerswarehouse", "broker": "brokers","rent": "rent", "analysis":"thor", "sell_analysis":"spider",
          "sell_api":"spider","rent_t":"rent"}
    mag = {"zhuge_dm": "zhuge_dm", "ccmag": "comphousemag", "brokers": "brokers", "hidden_etl": "count",
           "hidden_new": "count", "rules_template": "spider_rules", "avgprice": "statistics", "localhost": "test", "appraisal": "spider"}
    if type in bj:
        db = bj.get(type) + "_" + city
        return db
    elif type in not_bj:
        db = not_bj.get(type) if city == "bj" else not_bj.get(type) + "_" + city
        return db
    elif type in mag:
        return mag.get(type)


sell_old = ['bj', 'bd', 'cc', 'cd', 'cq', 'cs', 'cz', 'dg', 'dl', 'fz', 'guilin', 'gy', 'gz', 'heb', 'hf', 'hhht', 'hn',
            'huizhou', 'hz', 'jh', 'jm', 'jn', 'km', 'ks', 'lf', 'ly', 'lz', 'nb', 'nc', 'nj', 'nn', 'nt', 'qd', 'qhd',
            'qz', 'sh', 'sjz', 'su', 'sx', 'sy', 'sz', 'taiyuan', 'taizhou', 'tj', 'ts', 'weihai', 'wf', 'wh', 'wx',
            'xa', 'xaxq', 'xm', 'xz', 'yc', 'yinchuan', 'yt', 'yz', 'zh', 'zs', 'zz']

sell_new = ['fs', 'jx', 'wz', 'xianyang', 'jiujiang', 'wlmq', 'bh', 'lyg', 'tz', 'zhenjiang', 'huzhou', 'yancheng',
            'st', 'hd', 'wuhu', 'bt', 'chengde', 'dali', 'ganzhou', 'huaian', 'liuzhou', 'ls', 'mianyang', 'nanyang',
            'qujing', 'sq', 'xn', 'xx', 'zhangjiakou', 'zhuzhou', 'anshan', 'daqing', 'jining', 'zb', 'zhangzhou', 'zj',
            'linyi', 'putian', 'zhaoqing', 'jl', 'liuzhou', 'binzhou']


def getConfigName(city, type):
    if "sell" == type:
        if city in sell_old:
            return "sell"
        else:
            return "new_sell"
    elif "plathouse" == type:
        if city in sell_old:
            return "plathouse"
        else:
            return "new_plathouse"
    elif "plathouse" == type:
        if city in sell_old:
            return "plathouse"
        else:
            return "new_plathouse"
    return type
